---
title: "Source Database Setup"
description: "Configure your backend database for PowerSync"
sidebarTitle: "Overview"
---

## <Icon icon="elephant" iconType="solid" size="24"/> Postgres

<Check>
**Version compatibility**: PowerSync requires Postgres version 11 or greater.
</Check>

Configuring your Postgres database with PowerSync generally involves three tasks:

* Enable logical replication
* Create a PowerSync database user
* Create `powersync` publication

We have documented steps for some hosting providers:
<AccordionGroup>
<Accordion title="Supabase">
### 1\. Enable logical replication

Supabase has logical replication enabled by default — no action required.

### 2\. Create a PowerSync Database User

It is not currently possible to create a new user on Supabase with replication permissions without contacting their support. Instead, use the default `postgres` user.

### 3\. Create "powersync" Publication

The `postgres` user does not have access to create a publication for all tables. Instead, list each table explicitly.

This can also be done on the Supabase dashboard in the database _Replication_ page.

```sql
CREATE PUBLICATION powersync FOR TABLE public.lists, public.todos;
```
</Accordion>
<Accordion title="AWS RDS">

### Prerequisites

The instance must be publicly accessible using an IPv4 address.
<Frame>
  <img src="/images/setup-1.avif"/>
</Frame>

Access may be restricted to specific IPs if required — see [IP Filtering](/installation/database-setup/security-and-ip-filtering).

### 1\. Enable Logical Replication

Set the `rds.logical_replication` parameter to `1` in the parameter group for the instance.

<Frame>
  <img src="/images/setup-2.png"/>
</Frame>

### 2\. Create a PowerSync Database User

Create a PowerSync user on Postgres:

```sql
-- SQL to create powersync user

CREATE ROLE powersync_role WITH LOGIN PASSWORD 'myhighlyrandompassword';

-- Allow the role to perform replication tasks

GRANT rds_replication TO powersync_role;

-- Set up permissions for the newly created role

GRANT SELECT, INSERT, UPDATE, DELETE ON ALL TABLES IN SCHEMA public TO powersync_role;

```

For read-only access, only the `SELECT` privilege is required — `INSERT`, `UPDATE` and `DELETE` can be removed.

To restrict read access to specific tables, explicitly list allowed tables for both the `SELECT` privilege, and for the publication (as well as for any other publications that may exist).

### 3\. Create "powersync" Publication

```sql
-- Create publication to replicate tables. Specify a subset of tables if required.

-- NOTE: this must be named "powersync" at the moment

CREATE PUBLICATION powersync FOR ALL TABLES;
```
</Accordion>
<Accordion title="Azure Postgres">
PowerSync supports both "Azure Database for PostgreSQL" and "Azure Database for PostgreSQL Flexible Server".

### Prerequisites

The database must be accessible on the public internet. Once you have created your database, navigate to Settings -> Networking and enable **Public access.**

### 1\. Enable Logical Replication

Follow the steps as noted in this article to allow logical replication:

[https://learn.microsoft.com/en-us/azure/postgresql/flexible-server/concepts-logical#prerequisites-for-logical-replication-and-logical-decoding](https://learn.microsoft.com/en-us/azure/postgresql/flexible-server/concepts-logical#prerequisites-for-logical-replication-and-logical-decoding)

### 2\. Create a PowerSync Database User

Create a PowerSync user on Postgres:

```sql
-- SQL to create powersync user

CREATE ROLE powersync_role WITH REPLICATION LOGIN PASSWORD 'myhighlyrandompassword';

GRANT SELECT, INSERT, UPDATE, DELETE ON ALL TABLES IN SCHEMA public TO powersync_role;

```

For read-only access, only the `SELECT` privilege is required — `INSERT`, `UPDATE` and `DELETE` can be removed.

To restrict read access to specific tables, explicitly list allowed tables for both the `SELECT` privilege, and for the publication (as well as for any other publications that may exist).

### 3\. Create "powersync" Publication


```sql
-- Create publication to replicate tables. Specify a subset of tables if required.

-- NOTE: this must be named "powersync" at the moment

CREATE PUBLICATION powersync FOR ALL TABLES;

-- Example for specifying a subset of tables:

-- CREATE PUBLICATION powersync FOR table users, projects, user_projects, checklists;
```
</Accordion>
<Accordion title="Google Cloud SQL">


### 1\. Enable Logical Replication

In Google Cloud SQL Postgres, enabling the logical replication is done using flags:

<Frame>
  <img src="/images/setup-3.png"/>
</Frame>


### 2\. Create a PowerSync Database User

Create a PowerSync user on Postgres:


```sql
-- SQL to create powersync user

CREATE ROLE powersync_role WITH REPLICATION LOGIN PASSWORD 'myhighlyrandompassword';

GRANT SELECT, INSERT, UPDATE, DELETE ON ALL TABLES IN SCHEMA public TO powersync_role;

```

For read-only access, only the `SELECT` privilege is required — `INSERT`, `UPDATE` and `DELETE` can be removed.

To restrict read access to specific tables, explicitly list allowed tables for both the `SELECT` privilege, and for the publication (as well as for any other publications that may exist).

### 3\. Create "powersync" Publication


```sql
-- Create publication to replicate tables. Specify a subset of tables if required.

-- NOTE: this must be named "powersync" at the moment

CREATE PUBLICATION powersync FOR ALL TABLES;
```
</Accordion>
<Accordion title="Neon">


Neon is a serverless Postgres environment with an innovative pricing model that separates storage and compute.

### 1\. Enable Logical Replication

Open your project and navigate to "**Settings**" -> "**Beta**", then click "**Enable**".

<Frame>
  <img src="/images/setup-4.avif"/>
</Frame>

### 2\. Create a PowerSync Database User

Create a PowerSync user on Postgres:


```sql
-- SQL to create powersync user

CREATE ROLE powersync_role WITH REPLICATION LOGIN PASSWORD 'myhighlyrandompassword';

GRANT SELECT, INSERT, UPDATE, DELETE ON ALL TABLES IN SCHEMA public TO powersync_role;
```

For read-only access, only the `SELECT` privilege is required — `INSERT`, `UPDATE` and `DELETE` can be removed.

To restrict read access to specific tables, explicitly list allowed tables for both the `SELECT` privilege, and for the publication (as well as for any other publications that may exist).

### 3\. Create "powersync" Publication

```sql
-- Create publication to replicate tables. Specify a subset of tables if required.

-- NOTE: this must be named "powersync" at the moment

CREATE PUBLICATION powersync FOR ALL TABLES;
```
</Accordion>

<Accordion title="Fly Postgres">


Fly Postgres is a [Fly](https://fly.io/) app with [flyctl](https://fly.io/docs/flyctl/) sugar on top to help you bootstrap and manage a database cluster for your apps.

### 1\. Enable Logical Replication

Once you've deployed your Fly Postgres cluster, it's time to enable logical replication.

This is performed by running the below command:



```bash
fly pg config update --wal-level=logical
```

<Frame>
  <img src="/images/setup-5.avif"/>
</Frame>

### 2\. Create a PowerSync Database User

Create a PowerSync user on Postgres:



```sql
-- SQL to create powersync user

CREATE ROLE powersync_role WITH REPLICATION LOGIN PASSWORD 'myhighlyrandompassword';

GRANT SELECT, INSERT, UPDATE, DELETE ON ALL TABLES IN SCHEMA public TO powersync_role;
```

For read-only access, only the `SELECT` privilege is required — `INSERT`, `UPDATE` and `DELETE` can be removed.

To restrict read access to specific tables, explicitly list allowed tables for both the `SELECT` privilege, and for the publication (as well as for any other publications that may exist).

### 3\. Create "powersync" Publication



```sql
-- Create publication to replicate tables. Specify a subset of tables if required.

-- NOTE: this must be named "powersync" at the moment

CREATE PUBLICATION powersync FOR ALL TABLES;
```
</Accordion>
</AccordionGroup>

For other providers and self-hosted databases:

<Accordion title="Other / Self-hosted">
Need help? Simply contact us on [Discord](https://discord.gg/powersync) and we'll help you get set up.

### 1\. Enable Logical Replication

PowerSync reads the Postgres WAL using logical replication in order to create sync buckets in accordance with the specified PowerSync [Sync Rules](/usage/sync-rules).

If you are managing Postgres yourself, set `wal_level = logical` in your config file:

<Frame>
  <img src="/images/setup-6.avif"/>
</Frame>

Alternatively, you can use the below SQL commands to check and enable logical replication:



```sql
-- Check the replication type

SHOW wal_level;

-- Enable logical replication

ALTER SYSTEM SET wal_level = logical;
```

Note that Postgres must be restarted after changing this config.

If you're using a managed Postgres service, there may be a setting for this in the relevant section of the service's admin console.

### 2\. Create a PowerSync Database User

Create a PowerSync user on Postgres:



```sql
-- SQL to create powersync user

CREATE ROLE powersync_role WITH REPLICATION LOGIN PASSWORD 'myhighlyrandompassword';

GRANT SELECT, INSERT, UPDATE, DELETE ON ALL TABLES IN SCHEMA public TO powersync_role;
```

For read-only access, only the `SELECT` privilege is required — `INSERT`, `UPDATE` and `DELETE` can be removed.

To restrict read access to specific tables, explicitly list allowed tables for both the `SELECT` privilege, and for the publication (as well as for any other publications that may exist).

### 3\. Create "powersync" Publication



```sql
-- Create publication to replicate tables. Specify a subset of tables if required.

-- NOTE: this must be named "powersync" at the moment

CREATE PUBLICATION powersync FOR ALL TABLES;
```
</Accordion>

### Unsupported Hosted Postgres Providers

Due to the logical replication requirement, not all hosting providers are supported.

Notably, some "serverless Postgres" providers do not support logical replication, and are therefore not supported by PowerSync yet.

## <Icon icon="leaf" iconType="solid" size="24"/> MongoDB (Beta)

<Check>
**Version compatibility**: PowerSync requires MongoDB version 6.0 or greater.
</Check>

### Status of MongoDB support in PowerSync

In PowerSync nomenclature, Beta means the package is ready to be used for production given you have adequately tested your use case. We typically don't make any breaking API changes when moving from Beta to V1.

#### Alpha (Completed)

Refer to the instructions above on how to use the current alpha support for MongoDB.

**Known Issues (Alpha)**

- [x] **FIXED**: MongoDB -> PowerSync Service replication is not optimized for performance yet. We are targeting 2,000+ operations per second for the Beta.
- [x] **FIXED**: Unhelpful "Something went wrong" error in the Dashboard when PowerSync IPs have not been allowed for Atlas users (Network Access -> IP Access List)
- [x] **FIXED**: Unhelpful "Something went wrong" error in the Dashboard when `mongodb://` is used for the URI scheme; `mongodb+srv://` must be used
- [x] **FIXED**: Consistency guarantees are currently _eventually consistent_ — that is, operations can arrive out of order on the client. We are targeting to provide _causal+ consistency_ using  `changeStreamPreAndPostImages`. **Update:** Instances can now be configured to use Post Images to resolve consistency issues.

#### Beta (In Progress - ETA 2024Q4)
- [x] Availability in PowerSync Cloud
- [x] Fully functional diagnostics API
- [x] Validate that TLS connections Just Work ™️ without any additional configuration
- [x] Address all known issues in _Known Issues_

#### V1 (Not Started) — Estimated start 2025Q1

### Permissions required - MongoDB Atlas

For MongoDB Atlas databases, the minimum permissions are:

```
readWrite@<your_database>._powersync_checkpoints
read@<your_database>
```

To allow PowerSync to automatically configure enable [`changeStreamPreAndPostImages`](#post-images) on
replicated collections, instead use:

```
dbAdmin@<your_database>
```

If you are replicating from multiple databases in the cluster, you need read permissions on the entire cluster:

```
readAnyDatabase@admin
```


### Permissions required - Self-hosted

For self-hosted MongoDB, PowerSync requires the `find` and `changeStream` permissions on the database being replicated.

PowerSync also requires `createCollection`, `dropCollection`, `insert`, `update`, and `remove` permissions to the `_powersync_checkpoints` collection.

### Post-Images

To replicate data from MongoDB to PowerSync in a consistent manner, PowerSync
uses Change Streams with [post-images](https://www.mongodb.com/docs/v6.0/reference/command/collMod/#change-streams-with-document-pre--and-post-images) to get the complete document after each change.
This requires the `changeStreamPreAndPostImages` option to be enabled on replicated collections.

PowerSync supports three configuration options for post-images:

- `post_images: off`: Uses `fullDocument: 'updateLookup'` for backwards compatibility. This was the default for older instances. However, this may lead to consistency issues, so we strongly recommend enabling postImages support instead.
- `post_images: auto_configure` [Default for new instances]: Automatically configures the `changeStreamPreAndPostImages` option on collections as needed. 
- `post_images: read_only`: Uses `fullDocument: 'required'` and requires `changeStreamPreAndPostImages: { enabled: true }` to be set on every collection referenced in sync rules. Replication will error if this is not configured. Ideal when permissions are restricted.

  - To manually configure collections for `read_only` mode, run this on each collection:
  ```js
  db.runCommand( {
   collMod: <collection>,
   changeStreamPreAndPostImages: { enabled: <boolean> }
  } )
  ```
  - You can view which collections have the option enabled using:

  ```js
  db.getCollectionInfos().filter(c => c.options?.changeStreamPreAndPostImages?.enabled)
  ```


## <Icon icon="dolphin" iconType="solid" size="24"/> MySQL (Alpha)

<Info>
  This section is a work in progress. More details for MySQL connections are coming soon. In the meantime, ask on our [Discord server](https://discord.gg/powersync) if you have any questions.
</Info>

<Check>
**Version compatibility**: PowerSync requires MySQL version 5.7 or greater.
</Check>

MySQL connections use the [binary log](https://dev.mysql.com/doc/refman/8.4/en/binary-log.html) to replicate changes.

Generally, this requires the following config:

* `gtid_mode` : `ON`
* `enforce_gtid_consistency` : `ON`
* `binlog_format` : `ROW`

PowerSync also requires a user with replication permissions on the database. An example:

```sql
-- Create a user with necessary privileges
CREATE USER 'repl_user'@'%' IDENTIFIED BY 'good_password';

-- Grant replication client privilege
GRANT REPLICATION SLAVE, REPLICATION CLIENT ON *.* TO 'repl_user'@'%';

-- Grant access to the specific database
GRANT ALL PRIVILEGES ON powersync.* TO 'repl_user'@'%';

-- Apply changes
FLUSH PRIVILEGES;
```

## Next Step
Next, connect PowerSync to your database:

[Database Connection](/installation/database-connection)

<Tip>
**Self-hosting:** If you are self-hosting PowerSync, refer to [PowerSync Service Setup](/self-hosting/installation/powersync-service-setup) next.
</Tip>