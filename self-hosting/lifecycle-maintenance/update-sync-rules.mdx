---
title: "Update Sync Rules"
description: "How to update sync rules in a self-hosted PowerSync deployment"
---

## Overview

PowerSync provides an endpoint (`/api/sync-rules/v1/deploy`) to update sync rules without redeploying the service.  
This is useful for making quick adjustments or experimenting with synchronization logic at runtime.

<Info>
Sync rules defined in your `powersync.yaml` configuration file take **priority**.  
The deploy endpoint only applies if no sync rules are set in the config file.
</Info>

## Usage

### 1. Configure API token

Add an API token to your `powersync.yaml`:

```yaml
api:
  tokens:
    - !env PS_API_TOKEN
```

Restart the service to apply the configuration change.

### 2. Deploy Sync Rules

You can deploy sync rules either from a file: 

```shell
curl -X POST http://<your-powersync-host>:<port>/api/sync-rules/v1/deploy \
     -H "Content-Type: application/yaml" \
     -H "Authorization: Bearer ${PS_API_TOKEN}" \
     -d @path/to/your/sync-rules.yaml
```

Or inline:

```shell
curl -X POST http://<your-powersync-host>:<port>/api/sync-rules/v1/deploy \
     -H "Content-Type: application/yaml" \
     -H "Authorization: Bearer ${PS_API_TOKEN}" \
     -d 'bucket_definitions:
            global:
              data:
                - SELECT * FROM public.users'
```

You should receive a `200 OK` response with the following body.
The `slot_name` identifies the newly created [logical replication slot](/usage/lifecycle-maintenance/postgres-maintenance.mdx#logical-replication-slots).


```json
{ 
  "data": {
     "slot_name": "powersync_2_c1d3" 
  }
}
```

### Troubleshooting

If you get the following error, this indicates that sync rules are defined in your `powersync.yaml` file:

```json
{
  "error": {
    "status":422,
    "code":"PSYNC_S4105",
    "description":"Sync rules API disabled"
  }
}
```

To resolve, simply remove sync rules from your config file and restart the service.

## Notes

Keep your API token secure. Store it in an environment variable or a secure vault.

Remember: if sync rules are defined in `powersync.yaml`, API-deployed rules will be ignored.

This feature is best suited for testing or rapid iteration; for production deployments, version control your sync rules in `powersync.yaml`.